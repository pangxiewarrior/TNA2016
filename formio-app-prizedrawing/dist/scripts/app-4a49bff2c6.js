!function(){"use strict";angular.module("formioPrizeDrawing",["ngSanitize","ui.router","ui.bootstrap","formio"]).config(["$stateProvider","$urlRouterProvider","FormioProvider","AppConfig",function(o,t,e,r){e.setBaseUrl(r.apiUrl),o.state("register",{url:"/",templateUrl:"views/register.html",controller:["$scope","$state","$rootScope",function(o,t,e){o.$on("formSubmission",function(o,e){e&&t.go("done")})}]}).state("done",{url:"/done",templateUrl:"views/done.html"}).state("login",{url:"/login",templateUrl:"views/login.html",controller:["$scope","$state","$rootScope",function(o,t,e){o.$on("formSubmission",function(o,r){r&&(e.isAdmin=!0,localStorage.setItem("admin",1),e.user=r,t.go("drawing"))})}]}).state("drawing",{url:"/drawing",templateUrl:"views/drawing.html",controller:["$scope","$http","$rootScope","$state","Formio",function(o,t,e,r,n){return e.user?(o.winner=null,o.loading=!1,void(o.draw=function(){o.loading=!0;var r=e.registerForm+"/export?x-jwt-token="+n.getToken(),i=10;setTimeout(function(){t.get(r).then(function(t){o.loading=!1;var e=t.data.length,r=Math.floor(Math.random()*e);o.winner=t.data[r],localStorage.setItem("winner",o.winner.data.email)})},i)})):void r.go("register")}]}),t.otherwise("/")}]).run(["$rootScope","AppConfig","Formio","$state",function(o,t,e,r){o.user=null,o.adminLoginForm=t.appUrl+"/"+t.adminLoginPath,o.registerForm=t.appUrl+"/"+t.drawingFormPath,o.user||e.currentUser().then(function(t){o.user=t});var n=function(){o.user=null,r.go("register")},i=function(){o.user=null,r.go("register")};o.$on("formio.sessionExpired",i),o.$on("formio.unauthorized",n),o.logout=function(){e.logout().then(function(){o.user=null,r.go("register")})["catch"](i)},o.isActive=function(o){return-1!==r.current.name.indexOf(o)}}])}();